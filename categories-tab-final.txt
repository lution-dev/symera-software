                  <TabsContent value="categories" className="pt-4">
                    <div className="mb-4 text-sm text-muted-foreground px-1">
                      Visualize a distribuição do orçamento por categorias. Esta visão permite analisar onde estão concentrados os recursos do seu evento.
                    </div>
                    
                    {Object.keys(stats.byCategory).length === 0 ? (
                      <div className="text-center py-8">
                        <PieChart className="h-12 w-12 mx-auto text-muted-foreground mb-4" />
                        <h3 className="text-lg font-medium mb-2">Nenhum item no orçamento ainda</h3>
                        <p className="text-muted-foreground mb-4">
                          Adicione despesas ou itens para visualizar as estatísticas por categoria
                        </p>
                        <Button onClick={() => setIsAddItemOpen(true)}>
                          <Plus className="h-4 w-4 mr-2" />
                          Adicionar Despesa
                        </Button>
                      </div>
                    ) : (
                      <div className="space-y-6">
                        {/* Gráfico e Tabela de Análise */}
                        <div className="grid gap-6 md:grid-cols-2">
                          <Card>
                            <CardHeader>
                              <CardTitle className="flex items-center">
                                <PieChart className="h-5 w-5 mr-2 text-primary" />
                                Distribuição do Orçamento
                              </CardTitle>
                              <CardDescription>
                                Visualização da distribuição de gastos por categoria
                              </CardDescription>
                            </CardHeader>
                            <CardContent className="pt-2">
                              <div className="h-[300px] w-full">
                                <ResponsiveContainer width="100%" height="100%">
                                  <RechartsChart>
                                    <Pie
                                      data={Object.entries(stats.byCategory).map(([category, amount]) => ({
                                        name: BUDGET_CATEGORIES.find(c => c.value === category)?.label || (category === 'uncategorized' ? 'Sem Categoria' : category),
                                        value: amount
                                      }))}
                                      cx="50%"
                                      cy="50%"
                                      labelLine={true}
                                      label={({ name, percent }) => `${name}: ${(percent * 100).toFixed(0)}%`}
                                      outerRadius={80}
                                      fill="#8884d8"
                                      dataKey="value"
                                    >
                                      {Object.entries(stats.byCategory).map(([category, _], index) => (
                                        <Cell 
                                          key={`cell-${index}`} 
                                          fill={[
                                            "#8884d8", "#82ca9d", "#ffc658", "#ff8042", "#0088FE", 
                                            "#00C49F", "#FFBB28", "#FF8042", "#a4de6c", "#d0ed57"
                                          ][index % 10]} 
                                        />
                                      ))}
                                    </Pie>
                                    <Tooltip formatter={(value) => formatCurrency(value)} />
                                    <Legend />
                                  </RechartsChart>
                                </ResponsiveContainer>
                              </div>
                            </CardContent>
                          </Card>
                          
                          <Card>
                            <CardHeader>
                              <CardTitle className="flex items-center">
                                <Tag className="h-5 w-5 mr-2 text-primary" />
                                Detalhamento por Categoria
                              </CardTitle>
                              <CardDescription>
                                Detalhes específicos de cada categoria do orçamento
                              </CardDescription>
                            </CardHeader>
                            <CardContent className="pt-2">
                              <div className="overflow-auto max-h-[300px]">
                                <Table>
                                  <TableHeader>
                                    <TableRow>
                                      <TableHead>Categoria</TableHead>
                                      <TableHead className="text-right">Itens</TableHead>
                                      <TableHead className="text-right">Valor Total</TableHead>
                                      <TableHead className="text-right">% do Orçamento</TableHead>
                                    </TableRow>
                                  </TableHeader>
                                  <TableBody>
                                    {Object.entries(stats.byCategory).map(([category, amount]) => {
                                      const totalItemsInCategory = [
                                        ...expenses.filter(e => e.category === category),
                                        ...budgetItems.filter(i => i.category === category)
                                      ].length;
                                      
                                      const categoryPercent = stats.budget > 0 
                                        ? (amount / stats.budget) * 100 
                                        : (amount / stats.totalExpenses) * 100;
                                      
                                      return (
                                        <TableRow key={category}>
                                          <TableCell className="font-medium">
                                            {BUDGET_CATEGORIES.find(c => c.value === category)?.label || (category === 'uncategorized' ? 'Sem Categoria' : category)}
                                          </TableCell>
                                          <TableCell className="text-right">{totalItemsInCategory}</TableCell>
                                          <TableCell className="text-right">{formatCurrency(amount)}</TableCell>
                                          <TableCell className="text-right">{categoryPercent.toFixed(1)}%</TableCell>
                                        </TableRow>
                                      );
                                    })}
                                  </TableBody>
                                </Table>
                              </div>
                            </CardContent>
                          </Card>
                        </div>
                        
                        {/* Alerta para itens sem categoria */}
                        {(expenses.some(e => !e.category || e.category === 'uncategorized') || 
                          budgetItems.some(i => !i.category || i.category === 'uncategorized')) && (
                          <Alert className="bg-amber-50 border-amber-200">
                            <AlertCircle className="h-4 w-4 text-amber-600" />
                            <AlertTitle className="text-amber-800">Itens sem categoria</AlertTitle>
                            <AlertDescription className="text-amber-700">
                              Alguns itens não estão categorizados. Deseja categorizá-los agora?
                              <Button 
                                variant="outline" 
                                className="ml-4 border-amber-600 text-amber-700 hover:bg-amber-100"
                                onClick={() => document.querySelector('[value="expenses"]')?.dispatchEvent(new Event('click'))}
                              >
                                Categorizar Itens
                              </Button>
                            </AlertDescription>
                          </Alert>
                        )}
                      </div>
                    )}
                  </TabsContent>